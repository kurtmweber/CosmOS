//*****************************************************************
// This file is part of CosmOS                                    *
// Copyright (C) 2020-2021 Tom Everett                            *
// Released under the stated terms in the file LICENSE            *
// See the file "LICENSE" in the source distribution for details  *
// ****************************************************************

#include <dev/i386/keyboard/abstract_keyboard.h>
#include <types.h>

const uint8_t abstract_keyboard_grid[256] = {
    // this does not apply to multi-byte scan codes; those have to be interpreted separately
    // ordered by scan codes: high nibble grouped in rows, then read across to low nibble
    // only key-make scancodes are entered; key-break scancodes have a consistent offset and we process that separately from the lookup,
    // so everything in that range is 0xff
    // unused scancodes get 0xff, which signifies row 7/column 31, which we presume not to exist on any keyboard
    // if it ever does we'll have to reconsider this whole setup
    //	0	1	2	3	4	5	6	7	8	9	A	B	C	D	E	F
    /* 0 */ 0xFF,
    P(0, 0),
    P(1, 1),
    P(1, 2),
    P(1, 3),
    P(1, 4),
    P(1, 5),
    P(1, 6),
    P(1, 7),
    P(1, 8),
    P(1, 9),
    P(1, 10),
    P(1, 11),
    P(1, 12),
    P(1, 13),
    P(2, 0),
    /* 1 */ P(2, 1),
    P(2, 2),
    P(2, 3),
    P(2, 4),
    P(2, 5),
    P(2, 6),
    P(2, 7),
    P(2, 8),
    P(2, 9),
    P(2, 10),
    P(2, 11),
    P(2, 12),
    P(3, 12),
    P(5, 0),
    P(3, 1),
    P(3, 2),
    /* 2 */ P(3, 3),
    P(3, 4),
    P(3, 5),
    P(3, 6),
    P(3, 7),
    P(3, 8),
    P(3, 9),
    P(3, 10),
    P(3, 11),
    P(1, 0),
    P(4, 0),
    P(2, 13),
    P(4, 1),
    P(4, 2),
    P(4, 3),
    P(4, 4),
    /* 3 */ P(4, 5),
    P(4, 6),
    P(4, 7),
    P(4, 8),
    P(4, 9),
    P(4, 10),
    P(4, 11),
    P(4, 19),
    P(5, 2),
    P(5, 3),
    P(3, 0),
    P(0, 1),
    P(0, 2),
    P(0, 3),
    P(0, 4),
    P(0, 5),
    /* 4 */ P(0, 6),
    P(0, 7),
    P(0, 8),
    P(0, 9),
    P(0, 10),
    P(1, 17),
    P(0, 14),
    P(2, 17),
    P(2, 18),
    P(2, 19),
    P(1, 20),
    P(3, 13),
    P(3, 14),
    P(3, 15),
    P(2, 20),
    P(4, 13),
    /* 5 */ P(4, 14),
    P(4, 15),
    P(5, 11),
    P(5, 12),
    0xFF,
    0xFF,
    0xFF,
    P(0, 11),
    P(0, 12),
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 6 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 7 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 8 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 9 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* A */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* B */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* C */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* D */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* E */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* F */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF};

const uint8_t abstract_keyboard_grid_2byte[256] = {
    // this is for two-byte scan codes
    // indexed by vaue of the second byte, so if a scan code is e.g. 0xE0 0x15, then it will be at array index 0x15
    //	0	1	2	3	4	5	6	7	8	9	A	B	C	D	E	F
    /* 0 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 1 */ P(7, 13),
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    P(7, 14),
    0xFF,
    0xFF,
    P(4, 16),
    P(5, 7),
    0xFF,
    0xFF,
    /* 2 */ P(7, 8),
    P(7, 16),
    P(7, 11),
    0xFF,
    P(7, 12),
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    P(7, 10),
    0xFF,
    /* 3 */ P(7, 9),
    0xFF,
    P(7, 6),
    0xFF,
    0xFF,
    P(1, 18),
    0xFF,
    0xFF,
    P(5, 4),
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 4 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    P(7, 6),
    P(4, 12),
    P(1, 16),
    0xFF,
    P(5, 8),
    0xFF,
    P(5, 10),
    0xFF,
    P(2, 15),
    /* 5 */ P(5, 9),
    P(2, 16),
    P(1, 14),
    P(2, 14),
    0xFF,
    0xFF,
    0xFF,
    P(5, 1),
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    P(5, 5),
    P(5, 6),
    P(6, 1),
    P(6, 2),
    /* 6 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 7 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 8 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* 9 */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* A */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* B */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* C */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* D */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* E */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    /* F */ 0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF,
    0xFF};
